{% extends 'learningapp/base_student.html' %} {% block content %}
<div class="container-xl pt-3 p-md-3 p-lg-4">
  <div style="height: calc(100vh - 120px)">
    <h1 class="app-page-title">{{ greeting_message }} {{ user.username }}</h1>

    <div class="row g-4 mb-4">
      <div class="col-6 col-lg-4">
        <div class="app-card app-card-stat shadow-sm h-100">
          <div class="app-card-body p-3 p-lg-4">
            <h4 class="stats-type mb-1">Enrolled Courses</h4>
            <div class="stats-figure">{{ enrolled_courses }}</div>
          </div>
          <!--//app-card-body-->
          <a class="app-card-link-mask" href="#"></a>
        </div>
        <!--//app-card-->
      </div>
      <!--//col-->
      <div class="col-6 col-lg-4">
        <div class="app-card app-card-stat shadow-sm h-100">
          <div class="app-card-body p-3 p-lg-4">
            <h4 class="stats-type mb-1">Due Assignments</h4>
            <div class="stats-figure">{{ assignment_due_counts }}</div>
          </div>
          <!--//app-card-body-->
          <a class="app-card-link-mask" href="#"></a>
        </div>
        <!--//app-card-->
      </div>
      <!--//col-->
      <div class="col-6 col-lg-4">
        <div class="app-card app-card-stat shadow-sm h-100">
          <div class="app-card-body p-3 p-lg-4">
            <h4 class="stats-type mb-1">Due Quizzes</h4>
            <div class="stats-figure">6</div>
          </div>
          <!--//app-card-body-->
          <a class="app-card-link-mask" href="#"></a>
        </div>
        <!--//app-card-->
      </div>
      <!--//col-->
    </div>
    <h1 class="app-page-title">Plan Details</h1>

    <div class="col-12">
      <div class="app-card app-card-stat shadow-sm h-100">
        <div
          class="app-card-body p-3 p-lg-4"
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <div class="stats-figure" style="text-align: left">
            {{ user.membership}}
          </div>
          <div class="footer">
            {% if user.membership != 'EnlightLearn Platinum Plan' %}

            <button
              type="button"
              class="btn btn-info text-white"
              data-toggle="modal"
              href="#upgradePlanModal{{ user.id }}"
            >
              Upgrade Plan
            </button>
            {% endif %}

            {% if user.membership != 'EnlightLearn Free Plan' %}
            <button
              type="submit"
              class="btn btn-danger text-white"
              style="background: red"
              data-toggle="modal"
              href="#cancelPlan{{ user.id }}"
            >
              Cancel Plan
            </button>
            {% endif %}
          </div>
        </div>
      </div>
      <!--//app-card-->
    </div>
  </div>

  <div id="cancelPlan{{ user.id }}" class="modal fade">
    <div class="modal-dialog modal-confirm">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Cancel Plan</h4>
        </div>
        <div class="modal-body text-black">
          <p>
            Are you sure want to cancel plan
            <strong>{{ user.membersip }}</strong>? Please note this cannot be
            undone.
          </p>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-info text-white"
            data-dismiss="modal"
          >
            No
          </button>
          <form method="post" action="{% url 'cancel-plan' user.id %}">
            {% csrf_token %}
            <button
              type="submit"
              class="btn btn-danger text-white"
              style="background: red"
            >
              Yes
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div id="upgradePlanModal{{ user.id }}" class="modal fade">
    <div class="modal-dialog modal-confirm modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Upgrade plan</h4>
        </div>
        <div class="modal-body text-black">
          <p>
            Please select the plan you wish to upgrade to and proceed with the
            checkout process.
          </p>
          <div class="d-flex">
            {% if user.membership == 'EnlightLearn Free Plan' %}
            <form method="post" action="{% url 'checkout' 'S' user.id %}">
              {% csrf_token %}
              <button
                type="submit"
                class="btn btn-secondary text-white ml-2"
                style="margin-left: 4px"
              >
                Silver Plan
              </button>
            </form>
            {% endif %}
            {% if user.membership == 'EnlightLearn Silver Plan' or  user.membership == 'EnlightLearn Free Plan' %}
            <form method="post" action="{% url 'checkout' 'G' user.id %}">
              {% csrf_token %}
              <button
                type="submit"
                class="btn btn-warning text-white ml-2"
                style="margin-left: 4px"
              >
                Gold Plan
              </button>
            </form>
            {% endif %}
            {% if user.membership == 'EnlightLearn Silver Plan' or user.membership == 'EnlightLearn Gold Plan' or user.membership == 'EnlightLearn Free Plan' %}
            <form method="post" action="{% url 'checkout' 'P' user.id %}">
              {% csrf_token %}
              <button
                type="submit"
                class="btn btn-info text-white"
                style="margin-left: 4px"
              >
                Platinum Plan
              </button>
            </form>
            {% endif %}
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-danger text-white"
            data-dismiss="modal"
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
